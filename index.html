<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pythagoras's Game of Life :: AVIK Synesthesia</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #0a0014;
            font-family: 'Courier New', monospace;
            color: #00FFFF;
            overflow: hidden;
        }
        
        #container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        
        #header {
            padding: 20px;
            text-align: center;
            background: rgba(0, 0, 0, 0.8);
            border-bottom: 2px solid #FF00FF;
            box-shadow: 0 0 20px #FF00FF;
        }
        
        .avik-title {
            font-size: 48px;
            letter-spacing: 15px;
            font-weight: bold;
            margin-bottom: 10px;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 10px #FF00FF, 0 0 20px #FF1493, 0 0 30px #00FFFF; }
            to { text-shadow: 0 0 20px #FF00FF, 0 0 30px #FF1493, 0 0 40px #00FFFF; }
        }
        
        .letter-a { color: #FF1493; }
        .letter-v { color: #FFFF00; }
        .letter-i { color: #00FFFF; }
        .letter-k { color: #9D00FF; }
        
        .subtitle {
            font-size: 14px;
            color: #00FF00;
            letter-spacing: 3px;
            text-shadow: 0 0 10px #00FF00;
        }
        
        #main-area {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        #game-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background: radial-gradient(circle at center, #1a0033 0%, #0a0014 100%);
        }
        
        #gameCanvas {
            border: 3px solid #FF00FF;
            box-shadow: 0 0 40px #FF00FF, inset 0 0 40px rgba(255, 0, 255, 0.1);
            cursor: crosshair;
        }
        
        #sidebar {
            width: 350px;
            background: rgba(0, 0, 20, 0.9);
            border-left: 3px solid #00FFFF;
            box-shadow: 0 0 40px #00FFFF;
            padding: 20px;
            overflow-y: auto;
        }
        
        .section {
            margin-bottom: 25px;
            padding: 15px;
            background: rgba(255, 0, 255, 0.05);
            border: 1px solid #FF00FF;
            border-radius: 8px;
        }
        
        .section-title {
            font-size: 14px;
            color: #FF00FF;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 0 0 10px #FF00FF;
        }
        
        #controls {
            padding: 15px;
            background: rgba(0, 0, 0, 0.9);
            border-top: 3px solid #00FFFF;
            box-shadow: 0 0 20px #00FFFF;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        button {
            background: linear-gradient(135deg, #FF00FF 0%, #FF1493 100%);
            border: 2px solid #00FFFF;
            color: #FFFFFF;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 0 15px #FF00FF;
        }
        
        button:hover {
            transform: scale(1.1);
            box-shadow: 0 0 25px #FF00FF, 0 0 35px #00FFFF;
        }
        
        button.active {
            background: linear-gradient(135deg, #00FFFF 0%, #00FF00 100%);
            border-color: #FF00FF;
            box-shadow: 0 0 25px #00FFFF;
        }
        
        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(0, 255, 255, 0.05);
            padding: 8px 12px;
            border-radius: 5px;
            border: 1px solid #00FFFF;
        }
        
        label {
            font-size: 11px;
            color: #00FFFF;
            text-shadow: 0 0 5px #00FFFF;
        }
        
        input[type="range"] {
            width: 100px;
        }
        
        select {
            background: rgba(255, 0, 255, 0.2);
            border: 1px solid #FF00FF;
            color: #FFFFFF;
            padding: 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 11px;
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            font-size: 12px;
        }
        
        .metric-value {
            color: #00FFFF;
            font-weight: bold;
            text-shadow: 0 0 10px #00FFFF;
        }
        
        .seed-button {
            width: 100%;
            margin: 5px 0;
            background: linear-gradient(135deg, #9D00FF 0%, #FF00FF 100%);
        }
        
        .color-chip {
            display: inline-block;
            width: 30px;
            height: 30px;
            margin: 3px;
            border-radius: 5px;
            cursor: pointer;
            transition: transform 0.2s;
            box-shadow: 0 0 10px currentColor;
            border: 2px solid currentColor;
        }
        
        .color-chip:hover {
            transform: scale(1.3);
        }
        
        .color-chip.selected {
            border: 3px solid #FFFFFF;
            box-shadow: 0 0 20px currentColor;
        }
        
        #pythagoras-ratios {
            font-size: 11px;
            line-height: 1.8;
        }
        
        .ratio-line {
            display: flex;
            justify-content: space-between;
            padding: 3px 0;
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="header">
            <div class="avik-title">
                <span class="letter-a">A</span><span class="letter-v">V</span><span class="letter-i">I</span><span class="letter-k">K</span>
            </div>
            <div class="subtitle">PYTHAGORAS'S GAME OF LIFE :: SYNESTHETIC CELLULAR AUTOMATA</div>
        </div>
        
        <div id="main-area">
            <div id="game-container">
                <canvas id="gameCanvas"></canvas>
            </div>
            
            <div id="sidebar">
                <div class="section">
                    <div class="section-title">Metrics</div>
                    <div class="metric">
                        <span>Generation:</span>
                        <span class="metric-value" id="generation">0</span>
                    </div>
                    <div class="metric">
                        <span>Population:</span>
                        <span class="metric-value" id="population">0</span>
                    </div>
                    <div class="metric">
                        <span>Harmonic Ratio:</span>
                        <span class="metric-value" id="ratio">φ</span>
                    </div>
                    <div class="metric">
                        <span>Active Colors:</span>
                        <span class="metric-value" id="colors">0</span>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-title">AVIK Seeds</div>
                    <button class="seed-button" onclick="plantSeed('A')">A :: Audio (Pink)</button>
                    <button class="seed-button" onclick="plantSeed('V')">V :: Visual (Yellow)</button>
                    <button class="seed-button" onclick="plantSeed('I')">I :: Intelligence (Cyan)</button>
                    <button class="seed-button" onclick="plantSeed('K')">K :: Knot (Purple)</button>
                    <button class="seed-button" onclick="plantSeed('AVIK')">AVIK :: Full Pattern</button>
                </div>
                
                <div class="section">
                    <div class="section-title">Paint Mode</div>
                    <div id="colorPalette"></div>
                </div>
                
                <div class="section">
                    <div class="section-title">Pythagorean Ratios</div>
                    <div id="pythagoras-ratios">
                        <div class="ratio-line"><span>1:1</span><span style="color: #FFFFFF">Unison</span></div>
                        <div class="ratio-line"><span>2:1</span><span style="color: #00FFFF">Octave</span></div>
                        <div class="ratio-line"><span>3:2</span><span style="color: #00FF00">Fifth</span></div>
                        <div class="ratio-line"><span>4:3</span><span style="color: #FFFF00">Fourth</span></div>
                        <div class="ratio-line"><span>5:4</span><span style="color: #FF1493">Major Third</span></div>
                        <div class="ratio-line"><span>φ:1</span><span style="color: #FF00FF">Golden</span></div>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-title">Theory</div>
                    <div style="font-size: 10px; line-height: 1.6; color: rgba(255, 255, 255, 0.7);">
                        Letters & numbers evolve by Conway's rules, colored by synesthetic mapping.
                        Birth: 3 neighbors (1+2 duality)<br>
                        Survive: 2-3 neighbors<br>
                        Die: &lt;2 or &gt;3<br>
                        Pythagoras saw music in mathematics. AVIK hears color in computation.
                    </div>
                </div>
            </div>
        </div>
        
        <div id="controls">
            <button id="playBtn">▶ PLAY</button>
            <button id="stepBtn">STEP</button>
            <button id="clearBtn">CLEAR</button>
            <button id="randomBtn">RANDOM</button>
            
            <div class="control-group">
                <label>Speed:</label>
                <input type="range" id="speedSlider" min="1" max="20" value="5">
                <span id="speedValue">5</span>
            </div>
            
            <div class="control-group">
                <label>Mode:</label>
                <select id="modeSelect">
                    <option value="letters">Letters</option>
                    <option value="numbers">Numbers</option>
                    <option value="mixed">Mixed</option>
                </select>
            </div>
        </div>
    </div>
    
    <script>
        // Neon synthwave synesthesia colors
        const colorMap = {
            'p': '#FF00FF', 'q': '#FF00FF', '9': '#FF00FF',
            'a': '#FF1493', 'm': '#FF1493', '6': '#FF1493',
            'd': '#FF6600', 'r': '#FF6600', '3': '#FF6600',
            'b': '#FFFF00', 's': '#FFFF00', 'y': '#FFFF00', 'n': '#FFFF00', '4': '#FFFF00', '8': '#FFFF00',
            'c': '#00FF00', 'e': '#00FF00', 'f': '#00FF00', 'g': '#00FF00', 't': '#00FF00', '7': '#00FF00',
            'i': '#00FFFF', 'j': '#00FFFF', 'o': '#00FFFF', '2': '#00FFFF',
            '5': '#4682B4',
            'x': '#9D00FF', 'k': '#9D00FF', 'w': '#9D00FF',
            'l': '#FFFFFF', 'z': '#FFFFFF', '0': '#FFFFFF', '1': '#FFFFFF',
        };
        
        // Reverse lookup for palette
        const uniqueColors = [...new Set(Object.values(colorMap))];
        
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        const cellSize = 12;
        const cols = 70;
        const rows = 50;
        canvas.width = cols * cellSize;
        canvas.height = rows * cellSize;
        
        let grid = createGrid();
        let running = false;
        let generation = 0;
        let speed = 5;
        let lastUpdate = 0;
        let isDrawing = false;
        let mode = 'letters';
        let selectedColor = '#FF00FF';
        
        const letters = 'abcdefgijklmnopqrstxyz'.split('');
        const numbers = '0123456789'.split('');
        
        function createGrid() {
            return Array(rows).fill(null).map(() => Array(cols).fill(null));
        }
        
        function getCharForColor(color) {
            // Find a character that matches this color
            for (let [char, col] of Object.entries(colorMap)) {
                if (col === color) {
                    if (mode === 'letters' && isNaN(char)) return char;
                    if (mode === 'numbers' && !isNaN(char)) return char;
                    if (mode === 'mixed') return char;
                }
            }
            return 'a'; // default
        }
        
        function countNeighbors(x, y) {
            let count = 0;
            for (let i = -1; i <= 1; i++) {
                for (let j = -1; j <= 1; j++) {
                    if (i === 0 && j === 0) continue;
                    const newX = (x + i + rows) % rows;
                    const newY = (y + j + cols) % cols;
                    if (grid[newX][newY]) count++;
                }
            }
            return count;
        }
        
        function updateGrid() {
            const newGrid = createGrid();
            
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    const neighbors = countNeighbors(i, j);
                    const cell = grid[i][j];
                    
                    if (cell && (neighbors === 2 || neighbors === 3)) {
                        // Cell survives
                        newGrid[i][j] = cell;
                    } else if (!cell && neighbors === 3) {
                        // Birth - inherit from majority neighbor
                        const neighborChars = [];
                        for (let di = -1; di <= 1; di++) {
                            for (let dj = -1; dj <= 1; dj++) {
                                if (di === 0 && dj === 0) continue;
                                const ni = (i + di + rows) % rows;
                                const nj = (j + dj + cols) % cols;
                                if (grid[ni][nj]) neighborChars.push(grid[ni][nj]);
                            }
                        }
                        if (neighborChars.length > 0) {
                            newGrid[i][j] = neighborChars[Math.floor(Math.random() * neighborChars.length)];
                        }
                    }
                }
            }
            
            grid = newGrid;
            generation++;
            updateMetrics();
        }
        
        function drawGrid() {
            // Dark background with grid
            ctx.fillStyle = '#0a0014';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Grid lines
            ctx.strokeStyle = 'rgba(255, 0, 255, 0.1)';
            ctx.lineWidth = 0.5;
            
            for (let i = 0; i <= rows; i++) {
                ctx.beginPath();
                ctx.moveTo(0, i * cellSize);
                ctx.lineTo(cols * cellSize, i * cellSize);
                ctx.stroke();
            }
            
            for (let j = 0; j <= cols; j++) {
                ctx.beginPath();
                ctx.moveTo(j * cellSize, 0);
                ctx.lineTo(j * cellSize, rows * cellSize);
                ctx.stroke();
            }
            
            // Draw cells
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    if (grid[i][j]) {
                        const char = grid[i][j];
                        const color = colorMap[char] || '#FFFFFF';
                        
                        // Neon glow effect
                        ctx.fillStyle = color;
                        ctx.shadowColor = color;
                        ctx.shadowBlur = 15;
                        ctx.fillRect(
                            j * cellSize + 1,
                            i * cellSize + 1,
                            cellSize - 2,
                            cellSize - 2
                        );
                        
                        // Draw character
                        ctx.shadowBlur = 5;
                        ctx.fillStyle = '#000000';
                        ctx.font = 'bold 9px Courier New';
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        ctx.fillText(
                            char.toUpperCase(),
                            j * cellSize + cellSize / 2,
                            i * cellSize + cellSize / 2
                        );
                        
                        ctx.shadowBlur = 0;
                    }
                }
            }
        }
        
        function updateMetrics() {
            let population = 0;
            const colorSet = new Set();
            
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    if (grid[i][j]) {
                        population++;
                        colorSet.add(colorMap[grid[i][j]]);
                    }
                }
            }
            
            document.getElementById('generation').textContent = generation;
            document.getElementById('population').textContent = population;
            document.getElementById('colors').textContent = colorSet.size;
            
            // Calculate harmonic ratio based on population
            const ratio = population > 0 ? (population / (rows * cols)).toFixed(3) : 'φ';
            document.getElementById('ratio').textContent = ratio;
        }
        
        function plantSeed(seed) {
            const centerX = Math.floor(rows / 2);
            const centerY = Math.floor(cols / 2);
            
            const patterns = {
                'A': [
                    [0, 0, 'a'], [0, 1, 'a'], [0, 2, 'a'],
                    [1, 0, 'a'], [1, 2, 'a'],
                    [2, 0, 'a'], [2, 1, 'a'], [2, 2, 'a'],
                    [3, 0, 'a'], [3, 2, 'a']
                ],
                'V': [
                    [0, 0, 'y'], [0, 4, 'y'],
                    [1, 1, 'y'], [1, 3, 'y'],
                    [2, 2, 'y']
                ],
                'I': [
                    [0, 0, 'i'], [0, 1, 'i'], [0, 2, 'i'],
                    [1, 1, 'i'],
                    [2, 1, 'i'],
                    [3, 0, 'i'], [3, 1, 'i'], [3, 2, 'i']
                ],
                'K': [
                    [0, 0, 'k'], [0, 2, 'k'],
                    [1, 0, 'k'], [1, 1, 'k'],
                    [2, 0, 'k'], [2, 1, 'k'],
                    [3, 0, 'k'], [3, 2, 'k']
                ],
                'AVIK': [
                    // A
                    [-2, -5, 'a'], [-1, -6, 'a'], [-1, -4, 'a'], [0, -5, 'a'],
                    // V
                    [-2, -2, 'y'], [-1, -1, 'y'], [0, 0, 'y'], [-1, 1, 'y'], [-2, 2, 'y'],
                    // I
                    [-2, 4, 'i'], [-1, 4, 'i'], [0, 4, 'i'],
                    // K
                    [-2, 6, 'k'], [-1, 7, 'k'], [0, 6, 'k'], [1, 7, 'k']
                ]
            };
            
            const pattern = patterns[seed];
            pattern.forEach(([dx, dy, char]) => {
                const x = (centerX + dx + rows) % rows;
                const y = (centerY + dy + cols) % cols;
                grid[x][y] = char;
            });
            
            drawGrid();
            updateMetrics();
        }
        
        function toggleCell(x, y) {
            const col = Math.floor(x / cellSize);
            const row = Math.floor(y / cellSize);
            
            if (row >= 0 && row < rows && col >= 0 && col < cols) {
                const char = getCharForColor(selectedColor);
                grid[row][col] = grid[row][col] ? null : char;
            }
        }
        
        function createColorPalette() {
            const palette = document.getElementById('colorPalette');
            uniqueColors.forEach(color => {
                const chip = document.createElement('div');
                chip.className = 'color-chip';
                chip.style.backgroundColor = color;
                chip.style.color = color;
                if (color === selectedColor) chip.classList.add('selected');
                chip.onclick = () => {
                    selectedColor = color;
                    document.querySelectorAll('.color-chip').forEach(c => c.classList.remove('selected'));
                    chip.classList.add('selected');
                };
                palette.appendChild(chip);
            });
        }
        
        // Event listeners
        canvas.addEventListener('mousedown', (e) => {
            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            toggleCell(e.clientX - rect.left, e.clientY - rect.top);
            drawGrid();
            updateMetrics();
        });
        
        canvas.addEventListener('mousemove', (e) => {
            if (isDrawing) {
                const rect = canvas.getBoundingClientRect();
                toggleCell(e.clientX - rect.left, e.clientY - rect.top);
                drawGrid();
                updateMetrics();
            }
        });
        
        canvas.addEventListener('mouseup', () => {
            isDrawing = false;
        });
        
        document.getElementById('playBtn').addEventListener('click', (e) => {
            running = !running;
            e.target.textContent = running ? '⏸ PAUSE' : '▶ PLAY';
            e.target.classList.toggle('active');
        });
        
        document.getElementById('stepBtn').addEventListener('click', () => {
            updateGrid();
            drawGrid();
        });
        
        document.getElementById('clearBtn').addEventListener('click', () => {
            grid = createGrid();
            generation = 0;
            drawGrid();
            updateMetrics();
        });
        
        document.getElementById('randomBtn').addEventListener('click', () => {
            grid = createGrid();
            const chars = mode === 'letters' ? letters : mode === 'numbers' ? numbers : [...letters, ...numbers];
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    if (Math.random() > 0.85) {
                        grid[i][j] = chars[Math.floor(Math.random() * chars.length)];
                    }
                }
            }
            generation = 0;
            drawGrid();
            updateMetrics();
        });
        
        document.getElementById('speedSlider').addEventListener('input', (e) => {
            speed = parseInt(e.target.value);
            document.getElementById('speedValue').textContent = speed;
        });
        
        document.getElementById('modeSelect').addEventListener('change', (e) => {
            mode = e.target.value;
        });
        
        function animate(timestamp) {
            requestAnimationFrame(animate);
            
            const interval = 1000 / speed;
            
            if (running && timestamp - lastUpdate >= interval) {
                updateGrid();
                drawGrid();
                lastUpdate = timestamp;
            }
        }
        
        // Initialize
        createColorPalette();
        plantSeed('AVIK');
        drawGrid();
        updateMetrics();
        animate(0);
    </script>
</body>
</html>
